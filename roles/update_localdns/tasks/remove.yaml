---
- name: Remove DNS record(s) (from project)
  ansible.builtin.lineinfile:
    backup: true
    path: /etc/pihole/custom.list
    regexp: "{{ vm_name_list_item }}.{{ dns_suffix_list[0] }}"
    state: absent
  loop: "{{ vm_name_list }}"
  loop_control:
    loop_var: vm_name_list_item
  notify:
    - Restart pihole-FTL
  when: dns_suffix_list is defined

- name: Remove DNS record
  ansible.builtin.lineinfile:
    backup: true
    path: /etc/pihole/custom.list
    regexp: "{{ customhost }}"
    state: absent
  notify:
    - Restart pihole-FTL
  when: customhost is defined
